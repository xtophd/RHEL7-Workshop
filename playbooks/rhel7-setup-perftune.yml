---
- hosts: node1.example.com
  tasks:

    - name: "SETUP PERFTUNE: install packages"
      yum: name=pcp,pcp-gui,numad,numactl state=installed

    - name: "SETUP PERFTUNE: system service settings"
      service: name="{{ item.svc }}" state=stopped enabled=no
      with_items:
        - {svc: pmcd}
        - {svc: pmlogger}
        - {svc: numad}

    - name: "SETUP PERFTUNE: cheat script installs"
      template:
        src: "{{ item.src }}"
        dest: "{{ item.dest }}"
        owner: root
        group: root
        mode: 0755
      with_items:
        - {src: 'cheat-checkhost.j2', dest: '/usr/local/bin/cheat-systemd-perftune.sh'}
